# Minificando CSS

Em nosso projeto atual temos muitos arquivos css sendo carregados para estilizar nossas páginas. O problema é que cada carregamento gera uma requisição no servidor e isso leva tempo deixando sua aplicação ou site mais lentos.

Sem falar que cada espaço em branco que existe nos arquivos e cada quebra de linha também interfere na velocidade de carregamento para o servidor.

Uma boa prática é minificarmos os arquivos antes de subir o projeto para produção. Minificar reescrever todo código removendo espaços e quebras de linha, desta forma o arquivo fica muito menor e com uma leitura muito mais rápida.

Existem ferramentas online que fazem esta minificação, mas preferimos fazer este procedimento utilizando ferramentas locais.

Em nosso caso, utilizaremos o Node.js, que é uma linguagem server side baseada em javascript.

O primeiro passo é instalar o Node.js, em sua máquina, caso ainda não possua.

Acesse o link: <https://nodejs.org/en/>

Você vai ter acesso a duas versões: current e LTS.

| Versão | Descrição |
| ------ | --------- |
| LTS | Se trata da versão estável e que terá maior tempo de suporte |
| Current | Se trata da versão mais recente e que ainda pode haver problemas de compatibilidade |

Você pode escolher qualquer uma das duas para instalar, porque o procedimento que utilizaremos não terá problema em nenhuma delas.

Depois de instalar você deverá abrir o terminal de comando e acessar a pasta raiz do projeto. Acessando você deverá rodar os comandos abaixo:

`node -v` e `npm -v`

Estes comandos deverão retornar a versão tanto do node, quando to npm, que é a ferramenta de gerenciamento de pacotes do node. Caso não obtenha as versões quer dizer que houve algo errado com sua instalação.

Depois de ter certeza que estamos com tudo instalado corretamente você deverá instalar uma biblioteca chamada **minifier**. Rodando o comando abaixo:

`npm install -g minifier`

O parâmetro **-g** significa que a instalação será global, para que consigamos utilizar em outros projetos futuros também.

Depois de instalar a ferramante de minificar você deverá gerar os arquivos minificados. Então acesse a pasta **css** e dentro desta pasta rode o comando abaixo:

`minify pages`

Depois de rodar este comando você pode acessar a pasta **pages** e poderá ver que agora existem dois tipos de arquivos, o original e o minificado.

Veja a diferença entre os dois arquivos:

> contato.css Original

```css
@import url('../form.css');
@import url('../styles.css');

#header.page-contato {
    background-image: url("../../images/background-contato.jpg");
}

main {
    background-color: rgb(243, 240, 231);
}

.btn {
    border-radius: 0;
    padding: 20px 60px;
    font-size: 18px;
}
```
> contato.min.css Minificado

```css
input,textarea{border:1px solid #aaa;border-radius:2px;margin-bottom:30px;padding:10px;width:100%}input[type="submit"]{width:auto}textarea{height:170px}input:focus,textarea:focus{outline:1px solid #777}.input-control{position:relative}.input-control label{position:absolute;top:5px;left:5px;opacity:0}.input-control input:focus ~ label,.input-control textarea:focus ~ label{top:-25px;font-size:12px;transition:ease .5s all;opacity:1}
.container,.container-fluid{width:100%;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}.row:before,.row:after{content:" ";display:table}.row:after{clear:both}.col{position:relative;padding-left:15px;padding-right:15px;min-height:1px;float:left}.col-1{width:16.666666%}.col-2{width:33.333332%}.col-3{width:49.999998%}.col-4{width:66.666664%}.col-5{width:83.33333%}.col-6{width:100%}@media (min-width:992px){.container{max-width:992px;margin:0 auto}.col-desktop-1{width:8.333333%}.col-desktop-2{width:16.66%}.col-desktop-3{width:24.999999%}.col-desktop-4{width:33.333332%}.col-desktop-5{width:41.666665%}.col-desktop-6{width:49.999998%}.col-desktop-7{width:58.333331%}.col-desktop-8{width:66.666664%}.col-desktop-9{width:74.999997%}.col-desktop-10{width:83.33333%}.col-desktop-11{width:91.666663%}.col-desktop-12{width:100%}.col-offset-desktop-1{margin-left:8.333333%}.col-offset-desktop-2{margin-left:16.66%}.col-offset-desktop-3{margin-left:24.999999%}.col-offset-desktop-4{margin-left:33.333332%}.col-offset-desktop-5{margin-left:41.666665%}.col-offset-desktop-6{margin-left:49.999998%}.col-offset-desktop-7{margin-left:58.333331%}.col-offset-desktop-8{margin-left:66.666664%}.col-offset-desktop-9{margin-left:74.999997%}.col-offset-desktop-10{margin-left:83.33333%}.col-offset-desktop-11{margin-left:91.666663%}.col-offset-desktop-12{margin-left:100%}}@media (min-width:1200px){.container{max-width:1200px}}
*{box-sizing:border-box}body{margin:0;padding:0;font-size:14px}a{text-decoration:none}p{margin:10px 0 20px 0}
.btn{background-color:rgb(84,209,84);color:#fff;display:inline-block;border-radius:30px;padding:10px 30px;text-decoration:none;transition:ease .5s all;border:none;cursor:pointer}.btn:hover{background-color:rgb(84,180,84)}.btn.orange{background-color:#fed136}.btn.orange:hover{background-color:#000}
h2{text-transform:uppercase;font-weight:normal;text-align:center;font-size:25px;margin:10px 0 20px 0}h2:after{content:"";display:block;background-color:rgb(130,130,130);margin:5px auto 0 auto;width:50px;height:2px}.subtitle{margin-bottom:80px}.text-left{text-align:left}
.icon-container{display:inline-block;width:140px;height:140px;background:#e1f3e1;border-radius:30px;position:relative}.icon-container .material-icons{display:block;font-size:85px;color:rgb(84,209,84);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);cursor:default}.img-box-round{display:inline-block;border-radius:100%;overflow:hidden}.img-box-label:before{content:'';display:block;width:50%;height:60px;border-right:2px solid rgb(32,123,32);background:transparent;margin-bottom:10px}
nav ul,nav ul li{list-style:none;margin:0;padding:0}
body{font-family:'Open Sans',sans-serif;color:rgb(130,130,130);line-height:25px}#header nav a{display:inline-block;text-decoration:none;padding:10px;border-radius:5px}#header nav a:hover,#header nav a.active{background-color:rgba(84,209,84,0.3)}#header h1{font-size:54px;line-height:60px}#header{background:#000 no-repeat fixed center;background-size:cover;color:#fff;width:100%;height:660px;position:relative;padding-top:30px}#header a{color:#fff;transition:ease .5s all}#header nav{text-align:right}#header nav ul,#header nav ul li{display:inline-block}#header .title{position:absolute;left:0;top:50%;transform:translate(0,-50%);text-align:center}.section{padding:30px 0 30px 0}.section-center{text-align:center}#footer{background-color:rgb(51,51,51);text-align:left}#footer,#footer a{color:rgb(204,204,204)}#footer h3,#footer nav li{text-transform:uppercase}#footer h3:after{content:'';display:block;border-bottom:2px solid rgb(204,204,204);width:30px}#footer nav li{padding:3px 0}#footer nav li a:hover{color:rgb(255,255,255)}#footer .social{height:200px;line-height:200px;text-align:right}#footer .social a{display:inline-block;padding:0 0 0 10px;opacity:1}#footer .social a:hover{opacity:.5;transition:ease .3s all}#footer .social img{vertical-align:middle}#copyright{text-align:center;background-color:rgb(34,34,34);padding:10px}@media (max-width:992px){#header,#header nav{text-align:center}}
#header.page-contato{background-image:url(../../images/background-contato.jpg)}main{background-color:rgb(243,240,231)}.btn{border-radius:0;padding:20px 60px;font-size:18px}
```

Percebam que no arquivo original temos dois **@import**, isso significa que teríamos mais duas requisições, aumentando o tempo de carregamento. No arquivo minificado nós já incluímos o conteúdo dos imports no arquivo minificado tornando tudo um código só e com uma leitura muito mais rápida, para o servidor, apesar de ser, para nós, mais confuso.

Foi pensando nesta minificação que utilizarmos o **@import** durante o desenvolvimento, pois sabíamos que o código seria unificado posteriormente.

O próximo passo é trocar o carregamento do arquivo css, trocando o original pelo minificado. Veja abaixo as trocas:

| Antes | Depois |
| ----- | ------ |
| <link href="css/pages/clientes.css" rel="stylesheet"> | <link href="css/pages/clientes.min.css" rel="stylesheet"> |
| <link href="css/pages/contato.css" rel="stylesheet"> | <link href="css/pages/contato.min.css" rel="stylesheet"> |
| <link href="css/pages/equipe.css" rel="stylesheet"> | <link href="css/pages/equipe.min.css" rel="stylesheet"> |
| <link href="css/pages/home.css" rel="stylesheet"> | <link href="css/pages/home.min.css" rel="stylesheet"> |
| <link href="css/pages/produto.css" rel="stylesheet"> | <link href="css/pages/produto.min.css" rel="stylesheet"> |
| <link href="./css/pages/quem-somos.css" rel="stylesheet"> | <link href="./css/pages/quem-somos.min.css" rel="stylesheet"> |

Agora estamos utilizando boas práticas e temos um site com carregamento muito mais rápido e com menos requisições ao servidor.

Por este motivo fizemos toda aquela separação e estruturação no desenvolvimento.