# Últimos ajustes de login

Neste módulo faremos alguns ajustes finais para podermos prosseguir com o desenvolvimento do projeto.

Ao fazer o login estamos sendo redirecionado para a url **http://127.0.0.1:8000/accounts/profile/**, mas queremos configurar a url que quisermos para redirecionamento pós login.

Você pode ser redirecionado para a home, mas o sistema também pode não encontrar rota alguma e você ter um erro **404**, por não encontrar uma rota.

Na home também temos um nome fictício **CANDIDO_SOUZZA**, no cabeçalho da página, que queremos deixar dinâmico referênte ao nome do usuário logado. E quando não tiver ninguém logado queremos adicionar um link para a página de login.

Quando utilizamos o método **render** e passamos a request para o template, temos diversos dados que podemos utilizar para criar nossas lógicas e você pode usar e abusar destes dados para enriquecer a sua aplicação.

Para iniciar nossos ajustes finais, abra o arquivo **portal/templates/base.html**:

```html
<ul class="nav navbar-nav navbar-right navbar-right-market-place">

    {% if request.user.is_authenticated %}
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span>{{ request.user.username }}</span> <i class="fa fa-user-o"></i></a>
        <ul class="dropdown-menu">
            <li><a href="#">Minha conta</a></li>
            <li><a href="#">Sair</a></li>
        </ul>
    </li>
    {% else %}
    <li><a href="{% url 'login' %}">Fazer login</a></li>
    {% endif %}

    <li><a href="#"><i class="fa fa-bell-o"></i></a></li>
    <li><a href="#"><i class="fa fa-heart-o"></i> </a></li>
    <li><a href="#">Contato</a></li>
    <li><a href="#" class="option-sell">Vender</a></li>

    <!--deslogado-->
    <!--<li><a href="#">Cadastre-se</a></li>-->
    <!--<li><a href="#" class="option-sell">Entre</a></li>-->

</ul>
```

Vejam que estamos colocando o nome dinamicamente através da tag **{{ request.user.username }}**.

E estamos fazendo um teste se o usuário está ou não logado, através da condicional **{% if request.user.is_authenticated %}**, caso esteja logado mostramos o nome do usuário e os botões de ação da conta, caso contrário, utilizamos o **{% else %}** para adicionar o botão de fazer login.

Estamos utilizando a tag **url** para gerar o link dinamicamente, desta forma, acaso mude a rota não teremos problema algum na geração do link de login, porque a tag busca o nome de registro e forma a url a partir dele. A tag utilizar foi **{% url 'login' %}**.

Depois destas alterações no template base, temos que configurar a rota que os usuários serão redirecionados após fazer o login, que no momento está a rota padrão do Django **http://127.0.0.1:8000/accounts/profile/**.

Para configurar a rota de redirecionamento de login basta criarmos uma constante no arquivo **mktplace/settings.py**.

```python
LOGIN_REDIRECT_URL = '/'
```

Adicione esta constante no final do arquivo. Após a criação da constante você pode fazer o login e ser redirecionado diretamente para a home, ou para qualquer outra rota que queira, basta configurar.

Depois de fazer estas alterações já temos nosso processo de login e logout completos.