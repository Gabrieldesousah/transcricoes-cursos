# Organizando formulário

Agora que já fizemos as refatorações necessárias vamos organizar melhor os nossos formulários.

Se você analisar o formulário de criação e de edição, temos muito pouca diferença entre eles. Então o correto é criar um outro template que contenha o comum entre os dois formulários, desta forma quando fizermos uma alteração teremos os dois formulários atualizados simultaneamente.

Em nosso exemplo o fomulário é muito simples e tem apenas um campo, mas imagina um formulário maior. Imagine que tenha que fazer uma alteração neste formulário e você o utiliza em vários templates. Você teria que fazer a mesma alteração em todos os templates, então a boa prática é centralizar tudo em um template só para fazer a alteração apenas uma vez.

O que é particular em cada formulário deverá ser adicionado separadamente, mas o que é comum estará vindo de um formulário geral e padrão.

Dentro de *templates/category-costs* crie um arquivo chamado *_form.html.twig*. O _underscore_, como prefixo do nome do arquivo, é uma convenção que muitos programadores utilizam quando se trada apenas de um arquivo de renderização, você pode, ou não utilizar esta prática. Veja o conteúdo do arquivo:

```html
<form method="post" action="{{ action }}">
    <label class="control-label">Nome</label>
    <div class="form-group">
        <input class="form-control" type="text" placeholder="Nome" name="name" value="{{ category.name }}">
    </div>
    <button type="submit" class="btn btn-primary btn-block">
        <span class="glyphicon glyphicon-{{ submitIcon }}"></span>
    </button>
</form>
```

Este será nosso formulário padrão. Reparem que os campos que possam ser diferentes nós adicionamos variáveis, que configuraremos no template.

* {{ action }}
* {{ submitIcon }}

Agora veja como nós carregamos este formulário e como configuramos as variáveis.

#### Arquivo template/category-costs/create.html.twig

```html
{% extends 'layout.html.twig' %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        Nova categoria de custo
                    </h3>
                </div>
                <div class="panel-body">
                    {% set action = route('category-costs.store') %}
                    {% set submitIcon = 'floppy-disk' %}
                    {% include 'category-costs/_form.html.twig' %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
```

#### Arquivo template/category-costs/edit.html.twig

```html
{% extends 'layout.html.twig' %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        Nova categoria de custo
                    </h3>
                </div>
                <div class="panel-body">
                    {% set action = route('category-costs.update', {'id': category.id}) %}
                    {% set submitIcon = 'pencil' %}
                    {% include 'category-costs/_form.html.twig' %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
```

Desta forma temos o mesmo formulário sendo carregado com ícones e rotas diferentes.

Você pode não sentir muita diferença por ser um formulário pequeno, mas em um formulário com muitos campos com certeza teremos um código muito menos a ser analisado.

O mais importante é você saber que quando começa a repetir muito código, em muitos arquivos, é sinal de que algo pode ser melhorado. Não deixe para editar no futuro porque você pode ter um problema muito grande.

Procure sempre reutilizar códigos, para que seu trabalho seja o mais otimizado possível.

Depois de fazer estas alterações faça testes de criação e cadastro para garantir que está tudo funcionando corretamente.