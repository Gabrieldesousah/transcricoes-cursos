# Iniciando deploy no Heroku

O primeiro passo para iniciarmos o nosso deploy é criar uma conta no Heroku. Não precisa se preocupar porque você pode criar uma conta free, sem precisar investir nada agora.

Depois de criar sua conta e ter a ferramenta **Heroku** instalada em seu terminal, basta você fazer o login utilizando suas credenciais. Para isso rode o comando abaixo:

`heroku login`

Você terá que informar seu email e senha de cadastro no Heroku e se os dados estiverem corretos você consegue logar.

Depois de logar você terá que criar uma aplicação rodando outro comando:

`heroku create`

A plataforma criará sua aplicação e já disponibilizará um link para que você possa ter acesso online ao serviço. Você pode também configurar o DNS de um domínio próprio no Heroku, caso o tenha.

O próximo passo será informar, ao Heroku, qual o tipo de aplicação que você rodará neste serviço. Para isso criaremos um arquivo, na pasta raiz do projeto, com informações que o Heroku será capaz de ler e interpretar.

Teremos que informar ao Heroku qual é nosso **Document Root**, ou seja, qual será a nossa pasta pública, para que os usuários tenham acesso e outras configurações referentes ao servidor.

Crie o arquivo **Procfile.txt** na pasta raiz de nosso projeto. Veja o conteúdo deste arquivo:

```
web: vendor/bin/heroku-php-apache2 public/
```

Esta configuração informa que queremos trabalhar com a linguagem *PHP* e com o servidor *apache2*. Também informamos que nossa pasta pública é a *public*. Somente esta linha será capaz de configurar o serviço pra gente. Caso queira se aprofundar mais nos tipos de configurações você pode acessar o site e pesquisar, mas para este nosso conteúdo estas configurações bastam.

Todas as aplicações que você criar, no Heroku, estarão listadas em seu painel administrativo e você pode acessar qualquer uma delas para adicionar configurações, caso seja necessário. Existem configurações gratuitas e pagas.

O MySQL é um serviço pago no Heroku, por este motivo utilizaremos o serviço *PostgreSQL* para nosso banco de dados.

Existem diversas funcionalidade que podemos acrescentar no Heroku, mas seria muito informações para este conteúdo, então vamos ao que interessa, que são as variáveis de ambiente.

Em nosso servidor local estamos trabalhando com o arquivo **.env**, para configurar as variáveis de ambiente da aplicação, mas no Heroku não trabalharemos com este tipo de arquivo para variáveis de ambiente, por dois motivos:

1. O Heroku disponibiliza a criação de variáveis de embiente por painel.
2. Toda vez que fazemos um deploy o Heroku elimina os arquivos antigos gerando uma nova versão. Não teria problema nenhum em fazer isso porém, como o arquivo *.env* não faz parte do nosso controle de versão ele seria apagado a cada deploy, então teríamos que ficar criando este arquivo toda vez que fizéssemos qualquer alteração. Por este motivo, criaremos nossas variáveis de ambiente no painel e não utilizaremos o arquivo *.env*.

Para criar as variáveis de ambiente acesse a aplicação, pelo painel, e vá até **configurações/Settings**, depois clique em **Reveal Config Vars**. As variáveis são adicionadas através de chaves e valores. Exemplo:

`DB_HOST=localhost`

| Chave | Valor |
| ----- | ----- |
| DB_HOST | localhost |

Então adicione todas as variáveis que estão no arquivo *.env* de nossa aplicação:

```
DB_DRIVER=pgsql
DB_HOST=localhost
DB_DATABASE=son_financas
DB_USERNAME=root
DB_PASSWORD=root
```

Depois de adicionar as variáveis de ambiente, crie um banco da dados no Heroku indo até o menu **Resources**. Em resources adicionar um **Add-on**, pesquisando por *Heroku Postgres*.

Você terá muitas opções de planos *postgres*. Adicione o plano free, para esta nossa aplicação, mas é bom você saber que pode escolher um plano pago e também acessar os detalhes de cada plano.

Depois de instalar o postgres clique no banco criado para acessá-lo. Depois que acessar vá até **Credentials** para pegar os dados do banco criado.

Agora você precisa editar suas variáveis de ambiente colocando os dados das credenciais do seu banco de dados postgres. Altere **DB_HOST, DB_DATABASE, DB_USERNAME e DB_PASSWORD**.

Configuradas as variáveis de ambiente e com nossa aplicação criada terminaremos nosso deploy para que consigamos ver nossa aplicação funcionando online.

No próximo módulo terminaremos.