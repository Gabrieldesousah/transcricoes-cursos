# Configurando projeto com express

Agora que já temos a parte front-end pronta temos que começar a trabalhar com a API, para que consigamos consumir os dados vindos da parte administrativa do nosso projeto. Os dados serão consumidos e mostrados em um formato JSON.

Utilizaremos um projeto, open source, chamado **Socket.io**, juntamente com **websocket** para nos auxiliar nesta etapa.

Caso queira saber mais sobre o projeto *Socket.io* acesse <https://socket.io/>. Neste site você terá acesso a tudo que precisa saber, inclusive poderá contar com a documentação.

Este projeto facilita o trabalho e,m aplicações que utilizam o protocolo websocket, abstraindo alguns métodos tornando o nosso trabalho muito mais produtivo.

A instalação é muito simples e o projeto é sólido, o que deve lhe deixar tranquilo para utilizar em suas aplicações.

### Criando a API com express

Acesse a pasta raiz do seu projeto inicial, onde se encontram as pastas **admin** e **webapp**. Neste ponto você utilizará o **Express Generator** para gerar o esqueleto de nossa API.

Caso ainda não tenha instalado o Express Generator, rode o comando abaixo, no terminal:

`npm install express-generator -g`

Não se esqueça de adicionar o parâmetro **-g** para que a ferramenta seja instalada de forma global, permitindo que eu a utilize em qualquer local de minha máquina.

Depois de instalado basta rodar o comando abaixo para criar nosso esqueleto da *api*:

`express api`

Você terá a mensagem de confirmação de criação do projeto.

Depois de criar acesse a pasta *api* e verifique a seguinte estrutura criada:

| Diretório/Arquivo | Descrição |
| ----------------- | --------- |
| app.js | Arquivo inicial da aplicação |
| bin/ | Pasta de executáveis da aplicação |
| package.json | Arquivo gerenciador de dependências |
| public/ | Pasta disponibilizada ao usuário para acesso |
| routes/ | Pasta com todas as rotas, ou **endpoints**, da aplicação |
| views/ | Pasta com todas as views da aplicação |

Instale todas as dependências inicias rodando o comando:

`npm install`

Além das dependências iniciais precisaremos instalar mais algumas bibliotecas então rode os comando abaixo:

`npm install mongoose --save`

Depois de instalar a biblioteca **mongoose** temos que fazer uma conexão para efetuarmos as buscas no ambiente de desenvolvimento.

```js
// Carregando mongoose
var mongoose = require('mongoose');

// Criando conexão
mongoose.connect('mongodb://127.0.0.1:27017/chatschool_dev');
```

Depois de adicionar os códigos acima, estamos prontos para testar a conexão. Lembrando que você pode ter que iniciar o serviço do mongodb, em sua máquina, para deixar aguardando conexões, caso ainda não esteja rodando.

Para ativar basta acessar a pasta de instalação do mongodb e rodar o comando abaixo:

> Windows

Acessem a pasta binária da instalação do MongoDB  (c:\Program Files\MongoDB\Server\3.2\bin) e rodem o comando abaixo:

`mongod`

> Linux / Mac

`service mongod start` ou `brew services start mongodb`

Depende da maneira como instalou e qual sistema operacional está utilizando, mas certamente saberá como iniciar o serviço do MongoDB.

O próximo passo é rodar a aplicação para ver se não teremos nenhum erro. Existem duas formas:

1. Executando o arquivo app.js diretamente com node
	* `node app.js`
2. Executando o comando npm start
	* `npm start`

A segunda maneira é mais indicada porque ela gera configurações relacionadas a portas e ambientes.

Se não tiver nenhum erro é porque estamos prontos para começar o desenvolvimento de nossa API.