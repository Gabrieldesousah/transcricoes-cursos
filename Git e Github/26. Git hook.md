# Git hook

Agora que você já sabe que existe um tipo de repositório que só tem a finalidade de servir e para trabalhar como repositório central, nós mostraremos como podemos fazer o deploy automatizado.

Imagine que você está no seu repositório Git, trabalhando normalmente em sua máquina, e toda vez que você realizar um push, este repositório central irá copiar estes arquivos para uma outra pasta onde pode estar hospedado o seu site, por exemplo. Isso quer dizer que você vai trabalhar localmente e quando der um push o seu site será atualizado junto com sua versão local. Esta funcionalidade é realmente muito interessante, o que faz você ganhar tempo.

Para fazer esta configuração acesse o repositório aulagit.git do tipo **bare**, que criamos no módulo anterior, depois acesse a paste **hooks** e crie um arquivo chamado **post-receive**. Os hooks são ganchos que, quando determinada ação acontece, dispara outras ações pré-configuradas. Este arquivo post-receive nada mais é do que um outro gancho que será executado toda vez que dispararmos um push.

Dentro deste arquivo adicione o seguinte código:

```
#!/bin/sh
GIT\_WORK\_TREE=/Users/wesley/gitCode/meusite.com.br git checkout -f
```

A primeira linha indica que estamos trabalhando com comando do shell e a segunda é a configuração que indica para onde os arquivos serão copiados quando o push for executado. Percebam que passamos o parâmetro **-f** para que isso aconteça.

Depois disso dê permissão de execução para este arquivo rodando o comando `$ chmod +x post-receive`. E pronto, já temos o nosso hook configurado.

Agora devemos criar a pasta **meusite.com.br** que configuramos acima, para que na hora do push a mágica aconteça e os arquivos sejam copiados automaticamente para este endereço. Então criaremos dentro da pasta **gitCode**.

`mkdir meusite.com.br`

Caso queira confirmar abra esta pasta antes de dar qualquer push, para você ver que ela está vazia e depois do push ela terá os arquivos copiados.

Acesse o repositório aulagit e altere o arquivo **arquivo.txt**, adicione e comite este arquivo e realize o push. Percebam que agora temos duas opções de push:

1. git push origin master
2. git push local master

O primeiro nós enviamos para o repositório remoto do Github e o segundo realiza o push em nosso repositório remoto local e, consequentemente, em nossa pasta meusite.com.br, que acabamos de configurar. Depois que o repositório bare receber o push ele vai executar o push post-receive e enviar os arquivos para a pasta que configuramos.

O Git irá pedir a senha do seu usuário da máquina para concluir a operação.

Depois de realizado os dois push você pode acessar novamente a pasta meusite.com.br e verá que os arquivos já estarão la dentro, assim como esperado. Desta forma nós resolvemos nosso problema e ganhamos muito tempo de deploy, onde precisaríamos subir por FTP ou acessando o servidor de alguma outra forma.

Imagine que o repositório do tipo bare esteja no servidor de hospedagem do seu site e ele utilize o hook post-receive para direcionar os arquivos para a pasta public_html, por exemplo. É desta forma que conseguimos fazer o deploy online utilizando o Git.

Este não é a melhor forma do mundo de configurar o deploy, porque se você alterar arquivos de senha, por exemplo, você terá problema, mas de forma geral é uma opção muito interessante e que, em muitos casos, pode facilitar demais a sua vida.

Estamos fazendo estas configurações utilizando o ambiente Linux/Unix então procure trabalhar com o mesmo ambiente para que não tenha nenhum problema.

#Conclusão

Não gostaríamos de agradecer o interesse de todos.

Esperamos ter cumprido com o objetivo do conteúdo que era dar uma boa base de trabalho com Git e Github.

Não deixe de estudar e praticar, inclusive com projetos reais, para que o conteúdo esteja cada vez mais fixado e o mais natural possível para você.

Até o próximo tema.