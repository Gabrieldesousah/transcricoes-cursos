# Linux - Instalando PHP e Composer

Para que consigamos desenvolver a aplicação no ambiente Linux, vamos configurar nosso ambiente. Neste módulo instalaremos o PHP e o Composer.

No Linux existem vários tipos de distribuições e, por este motivo, a instalação das ferramentas são divergentes. No Ubuntu será de uma maneira, no Fedora vai ser de outra e assim por diante.

Por este motivo iremos mostrar algumas maneiras de instalar o PHP 7.1. No link abaixo existem algumas maneiras de instalar a ferramenta em diferentes distribuições:

<https://www.colinodell.com/blog/2016-12/installing-php-7-1>

### Instalando php7.1

Nós utilizaremos os comandos de Ubuntu, como base, mas você pode instalar na sua distribuição.

Se estiver utilizando o Ubuntu, rode os comandos abaixo:

```
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install php7.1
sudo apt-get install php-intl
```

O primeiro comando adiciona um repositório, o segundo atualiza todas as referências, o terceiro instala o php7.1, que é nosso objetivo final, e o quarto comando se trata de uma extensão que nos permite trabalhar com internacionalização de números, datas e outros recrusos.

Depois de instalado, para ter certeza que está instalado e configura, basta rodar o comando abaixo:

`php -v`

Você deverá ter a versão atual instalada.

### Instalando Composer

Nós utilizaremos muito o Composer em nosso projeto prático e, por este motivo, instalaremos em nossa máquina. É interessante que o Composer sempre seja intalado de forma global, para que você possa utilizar os comandos em qualquer projeto que quiser, sem precisar ficar levando o arquivo executável **composer.phar** para todos os projetos.

```
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php -r "if (hash\_file('SHA384', 'composer-setup.php') === '669656bab3166a7aff8a7506b8cb2d1c292f042046c5a994c43155c0be6190fa0355160742ab2e1c88d40d5be660b410') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
php composer-setup.php
php -r "unlink('composer-setup.php');"
```

A primeira linha fará uma cópia do instalador, a segunda linha verifica a instalação, a terceira linha executa a instalação e última linha destrói o arquivo **composer-setup.php**.

Depois disso já temos o arquivo composer.phar no local em que executou os comandos. Para ter certeza de que está funcionando basta você executar este arquivo.

`php composer.phar`

Você deverá ter uma listagem de todos os comandos do Composer. O próximo passo será mover este arquivo para a pasta binária do seu ambiente Linux, para que ele possa ser executado de qualquer local, fazendo parte das suas variáveis de ambiente.

`sudo mv composer.phar /usr/local/bin/composer`

Desta forma você já configurou o Composer, de forma global, e você já pode executar somente o comando **composer** no terminal, de qualquer local, para ter o mesmo resultado da execução local, que mostramos acima.

### Habilitando erros no php.ini

Esta é uma configuração extremamente importante, porque, quando estamos desenvolvendo, precisamos saber os erros que estão ocorrendo para que possamos corrigí-los. Alguns erros não são mostrados se você não habilitar no php.ini, então vamos fazer esta configuração para que estejamos a par de todos os erros durante o dessenvolvimento da nossa aplicação.

Para descobrir onde está o arquivo de configuração do php basta rodar o comando abaixo:

`php --ini`

Você deverá ter o caminho do arquivo em **Loaded Configuration File:**, depois disso basta abrir em um editor, de sua preferência, e configurar os seguintes itens.

```
error\_reporting = E\_ALL
display\_errors = On
display\_startup\_errors = On
log\_errors = On
```

Pesquise os itens acima e verifique se estão setados com os valores especificados.

Temos também que habilitar e configurar o arquivo de log de erros do php, ou seja, quando tiver um erro nós queremos que este erro seja gravado em um arquivo, para que possamos consultar o erro depois de gerado.

Para isso encontre as configuração abaixo:

```
; Log errors to specified file. PHP's default behavior is to leave this value
; empty.
; http://php.net/error-log
; Example:
error\_log = /var/log/php/php\_errors.log
```

Vejam que estamos passando um caminho para o arquivo de logs, então sempre que quiser verificar um erro você deverá acessar este caminho e analisar este arquivo. Confira se o caminho, que você passou, realmente existe, caso não exista você deverá criar para que não tenha erros.

Depois destas configurações feita execute o arquivo **test_mysql.php** novamente para ver se não teve nenhum erro. Se continuar tendo a conexão com o banco de dados, é porque estamos prontos para dar continuidade nos estudos.

`php test_mysql.php`