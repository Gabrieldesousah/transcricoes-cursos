# Integração com Twig

Mostraremos a ferramenta Twig, que também é desenvolvida pela equipe que mantém o Symfony Framework. Este equipe disponibiliza muitas outras ferramentas legais que a comunidade utiliza em larga escala.

O Twig é um template engine que irá nos ajudar a criar as views, que é a letra **V** do MVC.

Se não utilizarmos uma ferramenta de template engine, em nossa aplicação, nós vamos acabar misturando código PHP com HTML e continuaremos trabalhando fora do padrão MVC. Por mais que consigamos separar, uma hora fica insustentável e acabamos falhando neste conceito se não utilizarmos estas ferramentas.

Vamos imaginar a criação do front-end. Quando estamos desenvolvendo o layout estamos focados no HTML, que é uma linguagem de marcação, e estamos criando os elementos da nossa página e do nada adicionamos uma tag PHP. Este ato acaba poluindo nosso código e não é este o nosso intuito quando estamos desenvolvendo uma linguagem que vai rodar do lado do servidor.

Então o objetivo de trabalhar com template engine é trabalhar o mais próximo possível do HTML, trabalhar com uma linguagem mais simples e com a menor quantidade, possível, de símbolos.

O template engine é utilizado, muitas vezes, por pessoas que não são programadoras, porque sua sintaxe é muito mais simples do que programar manualmente. Ele tem estruturas que fazem a parte pesada por nós. No final das contas ele sempre criará um arquivo com o código PHP, mas isso fica invisível para nós.

O Twig trata a parte de segurança na hora de gerar os elementos no HTML, ele também torna a página mais rápida por trabalhar na otimização, ou seja, trabalhar com twig torna a página mais rápida do que se fizéssemos manualmente. Ele se preocupa em criar uma classe que vai fazer a renderização ficar mais rápida do que a convencional. Além de trabalhar com cache também.

Alguns desenvolvedores dizem que quando estamos adicionado algo a mais em nossa aplicação significa que vai torná-la mais lenta, e nem sempre é assim. Precisamos primeiro entender como a ferramenta funciona, por este motivo, apesar de parecer contraditório, mesmo adicionando mais funcionalidade nós estamos ganhando performance quando utilizamos um template engine, em nosso caso o Twig.

Para instalar o Twig rodaremos o seguinte comando, no terminal:

`composer require twig/twig:~1.0`

Depois de instalar a ferramenta criaremos mais um plugin, para integrar com a nossa aplicação.

Você pode duplicar o arquivo **RoutePlugin**, para não precisar criar um novo arquivo do zero.

```php
$container->addLazy('twig', function (ContainerInterface $container) {
    $loader = new \Twig_Loader_Filesystem(__DIR__ . '/../../templates');
    $twig = new \Twig_Environment($loader);
    return $twig;
});
```

O Twig irá renderizar as nossas páginas, conforme o template que passarmos para ele.

Estamos adicionando um serviço, do tipo Lazy, e estamos registrando como **twig**.

Dentro deste registro estamos instanciando uma classe, do Twig, e estamos passando o caminho da pasta, onde estarão as nossas views. Depois estamos instanciando outra classe, chamada **Twig_Environment**, que renderizará a view com base no objeto **$loader**, que instanciamos acima.

Não se esqueça de criar a pasta **templates** na pasta raiz do seu projeto.

Nós precisamos do Twig Environment instanciado para conseguir trabalhar com Twig.

Por enquanto o Container, que estamos passando como parâmetro para o regitro Lazy, não está sendo utilizado agora, mas utilizaremos no próximo módulo, então podem mentê-lo para o próximo.

Nós criaremos o renderizador dos nossos templates. Nosso renderizador próprio que utilizará o renderizador do Twig.

Estamos fazendo tudo do zero, assim como falamos no início do conteúdo, não queremos depender de nenhuma ferramenta, queremos apenas lhe mostrar como utilizar as ferramentas, mas tudo que envolve dependência nos engessa.

Tendo nosso renderizador não importa qual template engine vamos utilizar, porque estaremos preparados para trabalhar com todos eles.