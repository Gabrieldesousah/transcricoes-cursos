# Criando seeders

Agora falaremos de um novo conceito que é relacionado a biblioteca phinx, mas também relacionado a estruturação de desenvolvimento de um projeto. Este conceito está diretamente relacionado às migrações também.

Quantas vezes já não fomos desenvolver uma aplicação e perdemos muito tempo criando dados de teste manualmente. Nós temos a falsa impressão de que é perda de tempo desenvolver um este conceito para criação de conteúdos testes, mas no final perdemos mais tempo criando os conteúdo do que se tivessemos trabalhado com as seeds.

Então **seeds** são estruturas que podemos criar, em nossa aplicação, a fim de criar conteúdos de teste. Este conceito consiste em **semear** dados no banco de dados. Por este motivo o nome de seeds, que são sementes em inglês.

Seeds são classes, assim como as migrations, que são capazes de gerar dados aleatórios. Desta forma ao abrir sua aplicação, no front-end, você já terá dados sem precisar ficar cadastrando manualmente.

O trabalho com seeds é muito parecido com migrations, então rodaremos um comando para criar o arquivo e depois criaremos a função capaz de criar estes dados pra gente.

`vendor/bin/phinx seed:create CategoryCostsSeeder`

Com o comando acima você deve ter obtido o seguinte resultado no terminal:

```
using config file ./phinx.php
using config parser php
using migration paths
 - /Users/mac/www/son-financas/db/migrations
using seed paths
 - /Users/mac/www/son-financas/db/seeds
using seed base class Phinx\Seed\AbstractSeed
created ./db/seeds/CategoryCostsSeeder.php
```

Lembrando que a seeder deve ser utilizada somente em ambiente de desenvolvimento, caso precise adicionar dados em ambiente de produção você deverá criar uma migração.

Toda seeder irá extender da classe **AbstractSeed** e disponibilizará o método **run**. Veja o código abaixo:

```php
use Phinx\Seed\AbstractSeed;

class CategoryCostsSeeder extends AbstractSeed
{

    public function run()
    {
        $categoryCosts = $this->table('category_costs');

        $categoryCosts->insert([
            [
                'name' => 'Category 1',
                'created_at' => date('Y-m-d H:i:s'),
                'updated_at' => date('Y-m-d H:i:s')
            ],
            [
                'name' => 'Category 2',
                'created_at' => date('Y-m-d H:i:s'),
                'updated_at' => date('Y-m-d H:i:s')
            ]
        ])->save();
    }
}
```

Primeiro nós atribuímos a tabela a uma variável chamada **$categoryCosts**. Depois utilizamos o método **insert** para criar os valores. Vejam que cada array interno se refere a um dado, então basta ir duplicando para criar quantos dados quisermos no banco.

E depois temos que rodar o comando **save**, para concluir a inclusão no banco.

Para executar a seed basta rodar o comando abaixo:

`vendor/bin/phinx seed:run`

Depois de rodar este comando nossos dados já estarão no banco de dados. Lembrando que existe a possibilidade de passar o parâmetro **-e** para escolher o ambiente e também o **-s** caso queira rodar alguma seeder apenas, em específico. Em nosso caso sempre rodaremos todas as seeders então basta rodar o comando acima, que se tiver 10 seeders todas serão executadas.

```
mysql -uroot -proot
use category_costs;
select * from category_costs;
```

Rodando os comandos acima você terá os dados adicionados.

### Conclusão

O processo completo de criação e de destruição do nosso ambiente será da seguinte forma:

```
vendor/bin/phinx migrate
vendor/bin/phinx seed:run
vendor/bin/phinx rollback -t=0
vendor/bin/phinx migrate
vendor/bin/phinx seed:run
```

Desta forma estamos criando nosso ambiente com dados de teste, destruindo tudo e criando novamente. E podemos fazer isso quantas vezes forem necessárias de forma muito simples e rápida. Esta é a vantagem de utilizar o conceito de seeds.